@{
    ViewData["Title"] = "Ana Sayfa";
}

<div class="bg-primary text-white p-5 rounded-3 mb-5 shadow position-relative overflow-hidden">
    <i class="fa-solid fa-wallet position-absolute text-white opacity-25" style="font-size: 15rem; right: -50px; bottom: -50px;"></i>

    <div class="position-relative" style="z-index: 1;">
        <h1 class="display-4 fw-bold">EvimCebim'e Hoş Geldiniz</h1>
        <p class="lead my-3">
            Öğrenci evi giderlerinizi takip etmenin, bütçenizi yönetmenin ve harcamalarınızı analiz etmenin en akıllı yolu.
        </p>
        <div class="d-flex gap-3 mt-4">
            <a asp-controller="Expenses" asp-action="Index" class="btn btn-light btn-lg text-primary fw-bold shadow-sm">
                <i class="fa-solid fa-rocket me-2"></i>Hemen Başla
            </a>
            <a asp-controller="Expenses" asp-action="Create" class="btn btn-outline-light btn-lg fw-bold">
                <i class="fa-solid fa-plus me-2"></i>Harcama Ekle
            </a>
        </div>
    </div>
</div>

<div class="row text-center mb-5">

    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
            <div class="card-body p-4">
                <div class="feature-icon bg-primary bg-gradient text-white rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                    <i class="fa-solid fa-bolt fa-xl"></i>
                </div>
                <h4 class="card-title">Hızlı ve Kolay</h4>
                <p class="card-text text-muted">Harcamalarınızı saniyeler içinde kaydedin. Karmaşık menülerle uğraşmadan giderlerinizi sisteme girin.</p>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
            <div class="card-body p-4">
                <div class="feature-icon bg-success bg-gradient text-white rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                    <i class="fa-solid fa-chart-pie fa-xl"></i>
                </div>
                <h4 class="card-title">Görsel Analiz</h4>
                <p class="card-text text-muted">Paranızın nereye gittiğini merak mı ediyorsunuz? Detaylı grafikler ve özet raporlarla bütçenizi kontrol altına alın.</p>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card h-100 border-0 shadow-sm hover-effect">
            <div class="card-body p-4">
                <div class="feature-icon bg-warning bg-gradient text-white rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                    <i class="fa-solid fa-shield-halved fa-xl"></i>
                </div>
                <h4 class="card-title">Güvenli Veri</h4>
                <p class="card-text text-muted">Kayıtlarınız veritabanında güvenle saklanır. İstediğiniz zaman geçmişe dönük harcamalarınızı inceleyebilirsiniz.</p>
            </div>
        </div>
    </div>
</div>

<div class="row align-items-center mb-5 bg-light p-4 rounded shadow-sm">
    <div class="col-md-6">
        <h3 class="fw-bold text-dark"><i class="fa-solid fa-graduation-cap me-2 text-primary"></i>Neden EvimCebim?</h3>
        <p class="text-secondary">
            Öğrenci hayatında bütçe yönetimi zordur. Fatura tarihleri, market alışverişleri, ortak giderler derken hesaplar karışabilir.
            <strong>EvimCebim</strong>, bu karmaşayı bitirmek için tasarlandı.
        </p>
        <ul class="list-unstyled">
            <li class="mb-2"><i class="fa-solid fa-check text-success me-2"></i>Mobil uyumlu tasarım</li>
            <li class="mb-2"><i class="fa-solid fa-check text-success me-2"></i>Kategori bazlı takip</li>
            <li class="mb-2"><i class="fa-solid fa-check text-success me-2"></i>Anlık bütçe durumu</li>
        </ul>
    </div>
    <div class="col-md-6 text-center">
        <i class="fa-solid fa-users-viewfinder text-primary opacity-50" style="font-size: 8rem;"></i>
    </div>
</div>


<div class="card shadow-lg border-0 music-player-card"
     style="position: fixed; bottom: 20px; right: 20px; width: 280px; z-index: 9999; border-radius: 50px; background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%);">

    <div class="card-body p-2 d-flex align-items-center">
        <button id="playBtn" onclick="toggleMusic()" class="btn btn-light rounded-circle shadow-sm d-flex align-items-center justify-content-center"
                style="width: 50px; height: 50px; transition: transform 0.2s;">
            <i id="musicIcon" class="fa-solid fa-play text-danger fa-lg"></i>
        </button>

        <div class="ms-3 text-white" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
            <h6 class="mb-0 fw-bold">Tak Tak Tak</h6>
            <small style="font-size: 0.8rem;">Belkıs Özener</small>
        </div>

        <div class="ms-auto me-3 d-none" id="equalizer">
            <i class="fa-solid fa-music fa-bounce text-white"></i>
        </div>
    </div>
</div>




<div class="card shadow-lg border-0 music-player-card"
     style="position: fixed; bottom: 20px; right: 20px; width: 280px; z-index: 9999; border-radius: 50px; background: linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%); transition: all 0.3s ease;">

    <div class="card-body p-2 d-flex align-items-center">
        <button id="playBtn" onclick="userToggleMusic()" class="btn btn-light rounded-circle shadow-sm d-flex align-items-center justify-content-center"
                style="width: 50px; height: 50px; transition: transform 0.2s;">
            <i id="musicIcon" class="fa-solid fa-play text-danger fa-lg"></i>
        </button>

        <div class="ms-3 text-white" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">
            <h6 class="mb-0 fw-bold">Tak Tak Tak</h6>
            <small style="font-size: 0.8rem;">Belkıs Özener</small>
        </div>

        <div class="ms-auto me-3 d-none" id="equalizer">
            <i class="fa-solid fa-music fa-bounce text-white"></i>
        </div>
    </div>
</div>

<audio id="myAudio" loop>
    <source src="@Url.Content("~/audio/taktak.mp3")" type="audio/mpeg">
</audio>

<script>
    // Elementleri Seç
    var audio = document.getElementById("myAudio");
    var btn = document.getElementById("playBtn");
    var icon = document.getElementById("musicIcon");
    var eq = document.getElementById("equalizer");

    // --- AKILLI HAFIZA SİSTEMİ ---

    // 1. Sayfa Yüklendiğinde: "Nerede kalmıştık?"
    window.addEventListener('load', function() {
        // Hafızadan verileri oku
        var savedTime = localStorage.getItem("musicTime");
        var shouldPlay = localStorage.getItem("musicPlaying");

        // Eğer kayıtlı bir zaman varsa oraya atla
        if (savedTime) {
            audio.currentTime = parseFloat(savedTime);
        }

        // Eğer müzik "Çalıyor" durumundaysa devam et
        if (shouldPlay === "true") {
            var promise = audio.play();
            if (promise !== undefined) {
                promise.then(_ => {
                    updateUI(true); // Başarılı
                }).catch(error => {
                    // Tarayıcı otomatik engellediyse, ilk tıkta aç
                    document.body.addEventListener('click', function() {
                        if (localStorage.getItem("musicPlaying") === "true") {
                            audio.play();
                            updateUI(true);
                        }
                    }, { once: true });
                });
            }
        }
    });

    // 2. Sayfadan Ayrılırken: "Şu anki durumu kaydet"
    window.addEventListener('beforeunload', function() {
        localStorage.setItem("musicTime", audio.currentTime);
        // Durum zaten buton fonksiyonunda kaydediliyor ama garanti olsun
        localStorage.setItem("musicPlaying", !audio.paused);
    });

    // 3. Kullanıcı Butona Basarsa
    function userToggleMusic() {
        if (!audio.paused) {
            audio.pause();
            localStorage.setItem("musicPlaying", "false"); // Durduğunu kaydet
            updateUI(false);
        } else {
            audio.play();
            localStorage.setItem("musicPlaying", "true"); // Çaldığını kaydet
            updateUI(true);
        }
    }

    // Arayüz Güncelleme (İkonlar vb.)
    function updateUI(isPlaying) {
        if (isPlaying) {
            icon.className = "fa-solid fa-pause text-danger fa-lg";
            eq.classList.remove("d-none");
            btn.style.transform = "scale(1.1)";
        } else {
            icon.className = "fa-solid fa-play text-danger fa-lg";
            eq.classList.add("d-none");
            btn.style.transform = "scale(1)";
        }
    }
</script>
